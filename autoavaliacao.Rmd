---
title: Autoavaliação

geometry: "top=3cm,left=3cm,right=2cm,bottom=2cm"
link-citations: yes
always_allow_html: true
documentclass: book
papersize: a4

output:
  html_document:
    toc: true
    css:
      - ./CSS/generic.css
      - ./CSS/logo-above-toc.css
      - ./CSS/main-color.css
      - ./CSS/narrow-margins.css
      - ./CSS/responsive.css
  bookdown::pdf_book:
    toc: true
    lot: true
    lof: true
    number_sections: false
    includes:
      in_header: tex/preamble.tex
      before_body: [tex/cover-1.tex, tex/cover-2.tex]
    latex_engine: xelatex
    keep_tex: no
---

```{r quadrienal-vigente, results = "hide", echo = FALSE, include = FALSE, eval = has.sucupira.files}
# get years
source("Scripts/years-sucupira.R", local = knitr::knit_global())

# periodo
quadrienal.vigente <-
  2021:min(
    as.numeric(format(Sys.Date(), "%Y")),
    max(anos),
    2024)
```

```{r cover-one, echo = FALSE, include = FALSE, eval = knitr::is_html_output()}
source("Scripts/cover-1.R", local = knitr::knit_global())
source("Scripts/cover-2.R", local = knitr::knit_global())
```

```{=latex}
% unnumbered chapters and arabic page numbering
\backmatter

\clearpage
\markboth{}{}

\EnableFootNotes
```

<!--install and/or load all R packages-->
```{r setup, include = FALSE, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', out.width = "100%", results = "hide"}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.align = 'center',
  results = "asis",
  include = TRUE,
  out.width = "100%",
  knitr.kable.NA = '',
  knitr.table.format = "html",
  webshot = "webshot",
  dev = "png"
)
source("Scripts/all-required-packages.R", local = knitr::knit_global())
```

<!--script for inserting LOGO ABOVE THE TOC-->
```{js table-of-contents}
$(document).ready(function() {
  $('#TOC').parent().prepend('<div id=\"nav_logo\"><img src="PPG/Images/logo-programa.png"></div>');
  });
```

<!--script for sharing-->
<p align="right">
```{r share, eval = knitr::is_html_output()}
home <- metadata$repository_url
source("Scripts/social-media-sharing.R", local = knitr::knit_global())
```
</p>

```{r, eval = knitr::is_html_output()}
cat("## **Metodologia** {#metodologia .tabset}")
```

```{r, eval = !knitr::is_html_output()}
cat("## **Metodologia** {-}")
```

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !any(has.metodologia, has.autoavaliacao)}
cat('<br>')
```

```{r metodologia, eval = all(has.metodologia, knitr::is_html_output())}
# initialize all sheets
abas <- readxl::excel_sheets("PPG/Metodologia.xlsx")

# display each sheet in a tab
for (j in 1:length(abas)) {
  cat('\n\n<!-- -->\n\n')
  cat(paste0('### **', abas[j], '**'))
  cat('\n\n<!-- -->\n\n')
  metodologia.raw <-
    readxl::read_excel("PPG/Metodologia.xlsx",
                       sheet = abas[j],
                       col_types = c("text"))
  
  # replace the link by a tag
  Abrir <- matrix(NA, nrow = dim(metodologia.raw)[1])
  colnames(Abrir) <- "Abrir"
  # add hyperlinks
  for (i in 1:dim(metodologia.raw)[1]) {
    if (!is.na(metodologia.raw[i, 2])) {
      Abrir[i] <-
        paste0('<a href="',
               metodologia.raw[i, 2],
               '" target="_blank"',
               '>',
               "↗️" ,
               "</a>",
               sep = "")
    }
  }
  metodologia <- cbind(metodologia.raw[, -2], Abrir)
  
  # print table
  if (dim(metodologia)[1] != 0) {
    source("Scripts/table-with-buttons.R", local = knitr::knit_global())
    cat(knitr::knit_print(
      create_dt(metodologia, title = "Autoavaliação - Metodologias")
    ))
  } else {
    cat("*Sem dados para exibir*")
  }  
  # print end of tab rows
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a><br>')
}
```

```{r autoavaliacao, eval = all(has.autoavaliacao, knitr::is_html_output())}
# initialize all sheets
abas <- readxl::excel_sheets("PPG/Autoavaliação.xlsx")

# display each sheet in a tab
for (j in 1:length(abas)) {
  cat('\n\n<!-- -->\n\n')
  cat(paste0('### **', abas[j], '**'))
  cat('\n\n<!-- -->\n\n')
  autoavaliacao.raw <-
    readxl::read_excel("PPG/Autoavaliação.xlsx",
                       sheet = abas[j],
                       col_types = c("text"))
  
  # replace the link by a tag
  Abrir <- matrix(NA, nrow = dim(autoavaliacao.raw)[1])
  colnames(Abrir) <- "Abrir"
  # add hyperlinks
  for (i in 1:dim(autoavaliacao.raw)[1]) {
    if (!is.na(autoavaliacao.raw[i, 3])) {
      Abrir[i] <-
        paste0('<a href="',
               autoavaliacao.raw[i, 3],
               '" target="_blank"',
               '>',
               "↗️" ,
               "</a>",
               sep = "")
    }
  }
  autoavaliacao <- cbind(autoavaliacao.raw[, -3], Abrir)
  
  # print table
  if (dim(autoavaliacao)[1] != 0) {
    source("Scripts/table-with-buttons.R", local = knitr::knit_global())
    cat(knitr::knit_print(
      create_dt(autoavaliacao, title = "Autoavaliação - Autoavaliação")
    ))
  } else {
    cat("*Sem dados para exibir*")
  }
  
  # print end of tab rows
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a><br>')
}
```

```{=latex}
\newpage
```

<br>

```{r, eval = knitr::is_html_output()}
cat("## **Resultados** {#resultados .tabset}")
```

```{r, eval = !knitr::is_html_output()}
cat("## **Resultados** {-}")
```

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = knitr::is_html_output()}
cat("### **Dados completos**")
```

```{r, eval = !knitr::is_html_output()}
cat("### **Dados completos** {-}")
```

<!--script for generating STACKED HORIZONTAL BAR CHART-->

```{css barchart-css}
.row {
  display: flex;
  align-items: stretch;
  margin: 0 0;
}

.row .label {
  flex: 0 0 auto;
}

.row .bar-container {
  flex: 1;
  display: flex;
  align-items: stretch;
  justify-content: flex-start;
}

.row .bar {
  display: flex;
  justify-content: center;
  align-items: center;
}

.val-a { background: #18BC9C }
.val-b { background: #F39C12 }
```

<br>

```{r barchart-data, eval = any(has.sucupira.files, has.ppg.files), cache = TRUE, cache.path = "cache/missing/", eval = knitr::is_html_output()}
data.sucupira <- 0
if (has.sucupira.files) {
  # get amount of data from Sucupira XLSX files
  source("Scripts/get-sucupira-sheets-names.R",
         local = knitr::knit_global())
  abas <- sucupira.sheets
  
  for (i in 1:length(abas)) {
    aba <- abas[i]
    source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())
    data.sucupira <- sum(data.sucupira, !is.na(sucupira.raw))
  }
}

data.ppg <- 0
if (has.ppg.files) {
  # get amount of data from PPG XLSX files
  source("Scripts/get-ppg-xlsx-data.R", local = knitr::knit_global())
  if (length(files.to.read) != 0) {
    for (i in 1:length(files.to.read)) {
      abas <- excel_sheets(files.to.read[i])
      for (j in 1:length(abas)) {
        sheet <- abas[j]
        try(ppg.file <-
              readxl::read_excel(files.to.read[i], sheet = abas[j]),
            silent = TRUE)
        data.ppg <- sum(data.ppg, !is.na(ppg.file))
      }
    }
  }
}

# total data
total <- data.sucupira + data.ppg

# print stacked horizontal bar chart
cat('<div class="row">')
cat('<div class="bar-container">')
cat(
  paste0(
    '<div class="bar val-a" style="color:white; font-weight:bold; flex-basis:',
    data.sucupira / total * 100,
    '%">Plataforma Sucupira</div>'
  )
)
cat(
  paste0(
    '<div class="bar val-b" style="color:white; font-weight:bold; flex-basis:',
    data.ppg / total * 100,
    '%">Institucionais</div>'
  )
)
cat('</div>')
cat('</div>')

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

```{r, eval = knitr::is_html_output()}
cat("### **Dados perdidos**")
```

```{r, eval = !knitr::is_html_output()}
cat("### **Dados perdidos** {-}")
```

```{r missing-data-sucupira, cache = TRUE, cache.path = "cache/dados-perdidos/", eval = all(has.sucupira.files, knitr::is_html_output())}
# initialize data
missing.data <- c()

# get amount of data from Sucupira XLSX files
source("Scripts/get-sucupira-sheets-names.R",
       local = knitr::knit_global())

# get all years available
source("Scripts/years-sucupira.R", local = knitr::knit_global())

for (ii in 1:length(sucupira.sheets)) {
  sheet <- sucupira.sheets[ii]
  source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())
  
  # loop for every available year
  for (jj in 1:length(anos)) {
    # check index of missing data
    indexes <-
      which(is.na(sucupira.list[[jj]]) == TRUE, arr.ind = TRUE)
    if (dim(indexes)[1] != 0) {
      for (kk in 1:dim(indexes)[1]) {
        # get metadata about the missing data
        missing.data <-
          rbind(missing.data,
                cbind(anos[jj],
                      sucupira.sheets[ii],
                      colnames(sucupira.list[[jj]])[indexes[kk, 2]]
                      )
                )
      }
    }
  }
}

if (dim(missing.data)[1] != 0) {
  missing.data <- as.data.frame(missing.data)
  colnames(missing.data) <-
    c("Aba", "Ano", "Coluna")
  
  missing.data <- unique(missing.data)

  ids <- order(as.numeric(missing.data$'Ano'), decreasing = TRUE)
  table <- missing.data[ids, ]
  
  source("Scripts/table-with-buttons.R", local = knitr::knit_global())
  create_dt(table, title = "Autoavaliação - Dados perdidos na Sucupira")

} else {
  cat("*Sem dados para exibir*")
}

source("Scripts/fonte-capes.R", local = knitr::knit_global())
```

<br>

```{r, eval = knitr::is_html_output()}
cat("### **Documentos CAPES** {#documentos .tabset}")
```

```{r, eval = !knitr::is_html_output()}
cat("### **Documentos CAPES** {-}")
```

```{r apresentacao-periodos, eval = all(has.avaliacao, knitr::is_html_output())}
# initialize all sheets
abas <- excel_sheets("PPG/Avaliação.xlsx")

# display each sheet in a tab
for (i in 1:length(abas)) {
  cat('\n\n<!-- -->\n\n')
  cat(paste0('#### **', abas[i], '**'))
  cat('\n\n<!-- -->\n\n')
  periodo.raw <-
    readxl::read_excel("PPG/Avaliação.xlsx",
               sheet = abas[i],
               col_types = c("text"))
  
  # replace the link by a tag
  for (i in 1:dim(periodo.raw)[1]) {
    periodo.raw[i, 3] <-
      paste0('<a href="', periodo.raw[i,3],'" target="_blank"', '>', "↗️" ,"</a>")
  }
  
  # print table
  if (dim(periodo.raw)[1] != 0) {
    source("Scripts/table-with-buttons.R", local = knitr::knit_global())
    cat(knitr::knit_print(create_dt(periodo.raw, title = "Autoavaliação - Documentos CAPES")))
  } else {
    cat("*Sem dados para exibir*")
  }
  
  # print end of tab rows
  source("Scripts/fonte-capes.R", local = knitr::knit_global())
}
```

```{=latex}
\newpage
```

<br>

## **1. Programa** {#programa .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = knitr::is_html_output()}
cat("### **1.1.1**")
cat('\n\n')
cat("#### **Estrutura Acadêmica do Programa** {.tabset}")
cat('\n\n')
```

```{r, eval = !knitr::is_html_output()}
cat("### **1.1.1 Estrutura Acadêmica do Programa**")
cat('<br>')
```

##### **Objetivos**

```{r cursos-objetivos, eval = all(has.dados.cadastrais, knitr::is_html_output())}
# read separate sheets
cursos.raw <- readxl::read_excel("PPG/Dados Cadastrais.xlsx", sheet = "Cursos", col_types = c("text"))

cursos <- dplyr::select(cursos.raw, c("Nível", "Objetivos"))

# print tables
print(
  kableExtra::kable(cursos, align = c("l", rep("c", ncol(
    cursos
  ) - 2), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  )
)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

##### **Perfil do egresso**

```{r cursos-egressos, eval = all(has.dados.cadastrais, knitr::is_html_output())}
# read separate sheets
cursos.raw <- readxl::read_excel("PPG/Dados Cadastrais.xlsx", sheet = "Egressos", col_types = c("text"))

cursos <- dplyr::select(cursos.raw, c("Nível", "Objetivos"))

# print tables
print(
  kableExtra::kable(cursos, align = c("l", rep("c", ncol(
    cursos
  ) - 2), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  )
)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

##### **AC** {#descricao-ac}

```{r 1-1-1-AC, eval = all(has.dados.cadastrais, knitr::is_html_output())}
area.raw <-
  readxl::read_excel("PPG/Dados Cadastrais.xlsx",
                     sheet = "AC",
                     col_types = c("text"))
area.raw$Fim <- NULL
area.ativas <- area.raw

# print tables
ids <- order(area.ativas$'Área de Concentração', decreasing = FALSE)
area.ativas <- area.ativas[ids, ]

print(
  kableExtra::kable(area.ativas, align = c("l", rep(
    "c", ncol(area.ativas) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

##### **LP** {#descricao-lp}

```{r 1-1-1-LP, eval = all(has.dados.cadastrais, knitr::is_html_output())}
linhas.raw <-
  readxl::read_excel("PPG/Dados Cadastrais.xlsx",
             sheet = "LP",
             col_types = c("text"))
linhas.atual <- linhas.raw[is.na(linhas.raw$Fim),]
linhas.atual$Fim <- NULL

# print tables
ids <- order(linhas.atual$'Linhas de Pesquisa', decreasing = FALSE)
linhas.atual <- linhas.atual[ids, ]

print(
  kableExtra::kable(linhas.atual, align = c("l", rep(
    "c", ncol(linhas.atual) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

##### **PP** {#descricao-pp}

```{r 1-1-1-data, eval = all(has.sucupira.files, knitr::is_html_output())}
# projetos - membros
sheet <- "Projetos - Membros"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# get years
source("Scripts/years-sucupira.R", local = knitr::knit_global())
names(sucupira.list) <- as.character(anos)

# get data for the current period
sucupira <- sucupira.list[as.character(quadrienal.vigente)] %>%
  plyr::compact()
for(i in 1:length(sucupira)){
  sucupira[[i]] <- cbind(
    "Anos" = rep(quadrienal.vigente[i], times = dim(sucupira[[i]])[1]),
    sucupira[[i]]
  )
}
sucupira.df <- data.frame(do.call(dplyr::bind_rows, sucupira))
names(sucupira.df) <-
  names(sucupira[[as.character(max(as.numeric(quadrienal.vigente)))]])

# filter docente responsável
sucupira.df <-
  sucupira.df[sucupira.df$`Membro Responsável` == "Sim", ]

sucupira.df <-
  sucupira.df %>% dplyr::select(
    "Anos",
    "Área de Concentração",
    "Linha de Pesquisa",
    "Nome do Projeto de Pesquisa",
    "Nome do Membro do Projeto",
    "Categoria do Membro do Projeto",
    "Data de Início",
    "Data da Situação",
    "Situação"
  )
```

```{r 1-1-1-PP-DP, eval = all(has.sucupira.files, knitr::is_html_output())}
table.projetos <-
  data.frame(
    sucupira.df$`Área de Concentração`,
    sucupira.df$`Linha de Pesquisa`,
    sucupira.df$`Nome do Projeto de Pesquisa`,
    sucupira.df$`Nome do Membro do Projeto`,
    sucupira.df$`Situação`
  )

# remove duplicates
table.projetos <- table.projetos[!duplicated(table.projetos), ]

table.projetos <- table.projetos[order(table.projetos[, 1], table.projetos[, 2], table.projetos[, 3]),]
labels <- colnames(table.projetos)
# print tables
table.projetos[, 1] <-
  as.vector(unlist(lapply(table.projetos[, 1], FUN = str_to_upper)))
table.projetos[, 2] <-
  as.vector(unlist(lapply(table.projetos[, 2], FUN = str_to_sentence)))
table.projetos[, 3] <-
  as.vector(unlist(lapply(table.projetos[, 3], FUN = str_to_title)))
table.projetos <- cbind(seq(1,dim(table.projetos)[1]), table.projetos)

colnames(table.projetos) <-
  c("ID",
    "Área de Concentração",
    "Linha de Pesquisa",
    "Projeto de Pesquisa",
    "Membro Responsável",
    "Situação")

rownames(table.projetos) <- NULL
print(
  kableExtra::kable(table.projetos, align = c("l", rep(
    "c", ncol(table.projetos) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

##### **Docentes** {#docentes-linhas-pesquisa}

```{r 1-1-1-docentes, eval = all(has.sucupira.files, knitr::is_html_output())}
# remove duplicates
table.all <- sucupira.df[!duplicated(sucupira.df[, -1]), ]

# select data DOCENTES
table.doc <-
  table(table.all$`Nome do Membro do Projeto`[table.all$`Categoria do Membro do Projeto` == "Docente"],
        table.all$`Linha de Pesquisa`[table.all$`Categoria do Membro do Projeto` == "Docente"])

# add row totals
table.doc <- cbind(table.doc, rowSums(table.doc))
colnames(table.doc) <- c(head(colnames(table.doc), -1), "N")
# add column totals
table.doc <- rbind(table.doc, colSums(table.doc))
rownames(table.doc) <- c(head(rownames(table.doc), -1), "N")
# print tables
print(
  kableExtra::kable(
    table.doc,
    align = c("c", rep("c", ncol(table.doc) - 2), "r"),
    caption = "Docentes"
  ) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

##### **Pós-Docs** {#posdocs-linhas-pesquisa}

```{r 1-1-1-posdocs, eval = all(has.sucupira.files, knitr::is_html_output())}
# remove duplicates
table.all <- sucupira.df[!duplicated(sucupira.df[, -1]), ]

# select data POS-DOC
table.posdoc <- NULL
if (any(table.all$`Categoria do Membro do Projeto` == "Pós-Doc")) {
  table.posdoc <-
    table(table.all$`Nome do Membro do Projeto`[table.all$`Categoria do Membro do Projeto` == "Pós-Doc"],
          table.all$`Linha de Pesquisa`[table.all$`Categoria do Membro do Projeto` == "Pós-Doc"])
  # add row totals
  table.posdoc <- cbind(table.posdoc, rowSums(table.posdoc))
  colnames(table.posdoc) <- c(head(colnames(table.posdoc), -1), "N")
  # add column totals
  table.posdoc <- rbind(table.posdoc, colSums(table.posdoc))
  rownames(table.posdoc) <- c(head(rownames(table.posdoc), -1), "N")
  # print tables
  print(
    kableExtra::kable(
      table.posdoc,
      align = c("c", rep("c", ncol(table.posdoc) - 2), "r"),
      caption = "Pós-Doutorandos"
    ) %>% kableExtra::kable_styling(
      bootstrap_options = c("striped", "hover", "condensed", "responsive"),
      full_width = T,
      position = "center"
    ) %>% kableExtra::scroll_box(width = "100%")
  )
}

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>


##### **Síntese** {#coerencia-quantitativo}

```{r 1-1-1-ac, eval = all(has.sucupira.files, knitr::is_html_output())}
table.ac <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Área de Concentração`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.ac) <- NULL
table.ac <- cbind(unique(sucupira.df$`Área de Concentração`), table.ac)
colnames(table.ac) <-
  c("Área de Concentração", as.character(quadrienal.vigente))
for (i in 1:dim(table.ac)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.ac[i, j + 1] <-
      try(
        data$`Área de Concentração`[match(table.ac$`Área de Concentração`[i],data$`Área de Concentração`)]
          , silent = TRUE)
  }
}

table.ac.long <-
  tidyr::gather(table.ac[, -1],
                "Ano",
                "Área de Concentração",
                colnames(table.ac)[-1],
                factor_key = TRUE)

table.ac.long <- rbind(
  table.ac.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.ac)[1]),
    "Área de Concentração" = rep("Áreas", times = dim(table.ac)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Áreas", na.rm = TRUE), digits = 0)
}

# print tables
table.ac.gt <-
  gtsummary::tbl_summary(
    table.ac.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Área de Concentração'),
    type = "level",
    level_value = ("Áreas")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 1-1-1-lp, eval = all(has.sucupira.files, knitr::is_html_output())}
table.lp <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Linha de Pesquisa`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.lp) <- NULL
table.lp <- cbind(unique(sucupira.df$`Linha de Pesquisa`), table.lp)
colnames(table.lp) <-
  c("Linha de Pesquisa", as.character(quadrienal.vigente))
for (i in 1:dim(table.lp)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.lp[i, j + 1] <-
      try(
        data$`Linha de Pesquisa`[match(table.lp$`Linha de Pesquisa`[i],data$`Linha de Pesquisa`)]
          , silent = TRUE)
  }
}

table.lp.long <-
  tidyr::gather(table.lp[, -1],
                "Ano",
                "Linha de Pesquisa",
                colnames(table.lp)[-1],
                factor_key = TRUE)

table.lp.long <- rbind(
  table.lp.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.lp)[1]),
    "Linha de Pesquisa" = rep("Linhas", times = dim(table.lp)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Linhas", na.rm = TRUE), digits = 0)
}

# print tables
table.lp.gt <-
  gtsummary::tbl_summary(
    table.lp.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Linha de Pesquisa'),
    type = "level",
    level_value = ("Linhas")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 1-1-1-pp, eval = all(has.sucupira.files, knitr::is_html_output())}
table.pp <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome do Projeto de Pesquisa`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.pp) <- NULL
table.pp <- cbind(unique(sucupira.df$`Nome do Projeto de Pesquisa`), table.pp)
colnames(table.pp) <-
  c("Nome do Projeto de Pesquisa", as.character(quadrienal.vigente))
for (i in 1:dim(table.pp)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.pp[i, j + 1] <-
      try(
        data$`Linha de Pesquisa`[match(table.pp$`Nome do Projeto de Pesquisa`[i],data$`Nome do Projeto de Pesquisa`)]
          , silent = TRUE)
  }
}

table.pp.long <-
  tidyr::gather(table.pp[, -1],
                "Ano",
                "Nome do Projeto de Pesquisa",
                colnames(table.pp)[-1],
                factor_key = TRUE)

table.pp.long <- rbind(
  table.pp.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.pp)[1]),
    "Nome do Projeto de Pesquisa" = rep("Projetos", times = dim(table.pp)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Projetos", na.rm = TRUE), digits = 0)
}

colnames(table.pp.long) <- c("Ano", "Projetos de Pesquisa por Linha")

# print tables
table.pp.gt <-
  gtsummary::tbl_summary(
    table.pp.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Projetos de Pesquisa por Linha'),
    type = "level",
    level_value = ("Projetos")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 1-1-1-doc, eval = all(has.sucupira.files, knitr::is_html_output())}
table.doc <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome do Projeto de Pesquisa`[sucupira.df$`Categoria do Membro do Projeto` == "Docente"])),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.doc) <- NULL
table.doc <- cbind(unique(sucupira.df$`Nome do Projeto de Pesquisa`[sucupira.df$`Categoria do Membro do Projeto` == "Docente"]), table.doc)
colnames(table.doc) <-
  c("Nome do Projeto de Pesquisa", as.character(quadrienal.vigente))
for (i in 1:dim(table.doc)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.doc[i, j + 1] <-
      try(
        data$`Nome do Membro do Projeto`[match(table.doc$`Nome do Projeto de Pesquisa`[i],data$`Nome do Projeto de Pesquisa`)]
          , silent = TRUE)
  }
}

table.doc.long <-
  tidyr::gather(table.doc[, -1],
                "Ano",
                "Nome do Membro do Projeto",
                colnames(table.doc)[-1],
                factor_key = TRUE)

table.doc.long <- rbind(
  table.doc.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.doc)[1]),
    "Nome do Membro do Projeto" = rep("Membros", times = dim(table.doc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Membros", na.rm = TRUE), digits = 0)
}

colnames(table.doc.long) <- c("Ano", "Projetos de pesquisa por Docente")

# print tables
table.doc.gt <-
  gtsummary::tbl_summary(
    table.doc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Projetos de pesquisa por Docente'),
    type = "level",
    level_value = ("Membros")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 1-1-1-posdoc, eval = all(has.sucupira.files, knitr::is_html_output())}
table.posdoc <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome do Projeto de Pesquisa`[sucupira.df$`Categoria do Membro do Projeto` == "Pós-Doc"])),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.posdoc) <- NULL
table.posdoc <- cbind(unique(sucupira.df$`Nome do Projeto de Pesquisa`[sucupira.df$`Categoria do Membro do Projeto` == "Pós-Doc"]), table.posdoc)
colnames(table.posdoc) <-
  c("Nome do Projeto de Pesquisa", as.character(quadrienal.vigente))
for (i in 1:dim(table.posdoc)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.posdoc[i, j + 1] <-
      try(
        data$`Nome do Membro do Projeto`[match(table.posdoc$`Nome do Projeto de Pesquisa`[i],data$`Nome do Projeto de Pesquisa`)]
          , silent = TRUE)
  }
}

table.posdoc.long <-
  tidyr::gather(table.posdoc[, -1],
                "Ano",
                "Nome do Membro do Projeto",
                colnames(table.posdoc)[-1],
                factor_key = TRUE)

table.posdoc.long <- rbind(
  table.posdoc.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.posdoc)[1]),
    "Nome do Membro do Projeto" = rep("Membros", times = dim(table.posdoc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Membros", na.rm = TRUE), digits = 0)
}

colnames(table.posdoc.long) <- c("Ano", "Projetos de pesquisa por Pós-Doc")

# print tables
table.posdoc.gt <-
  gtsummary::tbl_summary(
    table.posdoc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Projetos de pesquisa por Pós-Doc'),
    type = "level",
    level_value = ("Membros")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 1-1-1-list-tables, eval = all(has.sucupira.files, knitr::is_html_output())}
# list all tables
table.all <-
  list(table.ac.gt,
       table.lp.gt,
       table.pp.gt,
       table.doc.gt,
       table.posdoc.gt)

# drop empty elements from list
table.all <- table.all[lapply(table.all, length) > 0]

tbl <- gtsummary::tbl_stack(table.all)

# print all tables stacked
if(knitr::is_html_output()){
  tbl %>%
  print()
} else {
  tbl  %>%
  gtsummary::as_gt() %>%
  gt::as_latex() %>%
  print()
}

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<details>
<summary>Área de Concentração | Dados individuais</summary>
```{r ac-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.ac, align = c("l", rep(
    "c", ncol(table.ac) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Linhas de pesquisa | Dados individuais</summary>
```{r lp-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.lp, align = c("l", rep(
    "c", ncol(table.lp) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Projetos de pesquisa | Dados individuais</summary>
```{r pp-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.pp, align = c("l", rep(
    "c", ncol(table.pp) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Docentes | Dados individuais</summary>
```{r doc-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.doc, align = c("l", rep(
    "c", ncol(table.doc) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Pós-Docs | Dados individuais</summary>
```{r posdoc-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.posdoc, align = c("l", rep(
    "c", ncol(table.posdoc) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<br>

### **1.1.2**

#### **Proposta Curricular do Programa** {.tabset}

##### *Qualitativa*

<br>

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

##### *Quantitativa*

```{r 1-1-2-quanti, eval = all(has.sucupira.files, knitr::is_html_output())}
# read each tab content
sheet <- "Disciplinas"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# get all years available
source("Scripts/years-sucupira.R", local = knitr::knit_global())
names(sucupira.list) <- as.character(anos)

síntese.ano <- c()
# loop for every available year
for (i in 1:length(anos)) {
  # get síntese anual
  source("Scripts/síntese-sucupira.R", local = knitr::knit_global())
  síntese.ano <-
    dplyr::bind_rows(síntese.ano,
          sintese(
            sucupira.list = sucupira.list,
            ano = anos[i]
          ))
}

# Data selection
síntese.ano <- síntese.ano %>%
  dplyr::select(c(
    "Ano",
    "Níveis de curso",
    "Mestrado",
    "Doutorado",
    "Disciplinas (M)",
    "Disciplinas (D)",
    "Disciplinas obrigatórias (M)",
    "Disciplinas obrigatórias (D)",
    "Disciplinas eletivas (M)",
    "Disciplinas eletivas (D)",
    "Créditos totais (M)",
    "Créditos totais (D)",
    "Carga horária total (M)",
    "Carga horária total (D)"
    ))

# generate table (total by year)
table.1.1.2 <-
  gtsummary::tbl_summary(
    síntese.ano,
    by = "Ano",
    type = list(
      "Níveis de curso" ~ "continuous",
      "Mestrado" ~ "continuous",
      "Doutorado" ~ "continuous",
      "Disciplinas (M)" ~ "continuous",
      "Disciplinas (D)" ~ "continuous",
      "Disciplinas obrigatórias (M)" ~ "continuous",
      "Disciplinas obrigatórias (D)" ~ "continuous",
      "Disciplinas eletivas (M)" ~ "continuous",
      "Disciplinas eletivas (D)" ~ "continuous",
      "Créditos totais (M)" ~ "continuous",
      "Créditos totais (D)" ~ "continuous",
      "Carga horária total (M)" ~ "continuous",
      "Carga horária total (D)" ~ "continuous"
      ),
    statistic = list(
      all_continuous() ~ c("{max}")),
    missing = "no",
    digits = list(everything() ~ 0)) %>%
  gtsummary::modify_header(
    label = "**Ano**",
    all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(
    tidyselect::everything() ~ NA) %>%
  gtsummary::bold_labels()

# print table
print(table.1.1.2)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

### **1.1.3**

#### **Infraestrutura**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **1.2.1**

#### **Dimensão do corpo Docente Permanente**

```{r categoria-corpo-docente, eval = all(has.sucupira.files, knitr::is_html_output())}
# docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R")

# get years
source("Scripts/years-sucupira.R")
names(sucupira.list) <- as.character(anos)

# get docentes for the current period
sucupira <- sucupira.list[as.character(quadrienal.vigente)] %>%
  compact()
sucupira <- data.frame(do.call(dplyr::bind_rows, sucupira))
names(sucupira) <-
  names(sucupira.list[[as.character(max(as.numeric(names(sucupira.list))))]])

# recode
sucupira$'Data de Admissão' <-
  substr(as.Date(sucupira$'Data de Admissão', format = "%d/%m/%Y"), 1, 4)
sucupira$'Data de Desligamento' <-
  substr(as.Date(sucupira$'Data de Desligamento', format = "%d/%m/%Y"),
         1,
         4)
sucupira$'Data de Desligamento'[is.na(sucupira$'Data de Desligamento')] <-
  "Atual"

# filter duplicated docentes (changes in details will we exhibited)
docentes <-
  sucupira[!duplicated(sucupira[, match("Nome Docente", colnames(sucupira)):match("Categoria", colnames(sucupira))]), ]
docentes <- docentes[order(docentes$"Nome Docente"),]

# generate tables
table.doc <- data.frame(matrix(NA, nrow = dim(docentes)[1], ncol = length(quadrienal.vigente)))
rownames(table.doc) <- NULL
table.doc <- cbind(docentes$`Nome Docente`, table.doc)
colnames(table.doc) <- c("Nome Docente", as.character(quadrienal.vigente))
for (i in 1:dim(docentes)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    sucupira.temp <-
      sucupira.list[as.character(quadrienal.vigente[j])][[1]]
    
    table.doc[i, j + 1] <-
      try(sucupira.temp$'Categoria'[match(table.doc$`Nome Docente`[i], sucupira.temp$`Nome Docente`)]
          , silent = TRUE)
  }
}
table.doc.1 <- table.doc

table.doc.long <- tidyr::gather(table.doc[, -1], "Ano", "Categoria", colnames(table.doc)[-1], factor_key=TRUE)

table.doc.long <- rbind(
  table.doc.long,
  data.frame(
    "Ano" = rep(paste0(min(quadrienal.vigente), "-", max(quadrienal.vigente)), times = dim(table.doc)[1]),
    "Categoria" = rep("Docentes", times = dim(table.doc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Docentes", na.rm = TRUE), digits = 0)
}

# print tables
table.1a <-
  gtsummary::tbl_summary(
    table.doc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(
    list(
      add_stat_1 ~ "**N (Quadriênio)**",
      all_stat_cols() ~ "**{level}**"
    )
  ) %>%  
  remove_row_type(variables = c('Categoria'), 
                  type = "level", level_value = ("Docentes")) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r vinculacao-corpo-docente, eval = all(has.sucupira.files, knitr::is_html_output())}
# docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R")

# get years
source("Scripts/years-sucupira.R")
names(sucupira.list) <- as.character(anos)

# get docentes for the current period
sucupira <- sucupira.list[as.character(quadrienal.vigente)] %>%
  compact()
sucupira <- data.frame(do.call(dplyr::bind_rows, sucupira))
names(sucupira) <-
  names(sucupira.list[[as.character(max(as.numeric(names(sucupira.list))))]])

# recode
sucupira$'Data de Admissão' <-
  substr(as.Date(sucupira$'Data de Admissão', format = "%d/%m/%Y"), 1, 4)
sucupira$'Data de Desligamento' <-
  substr(as.Date(sucupira$'Data de Desligamento', format = "%d/%m/%Y"),
         1,
         4)
sucupira$'Data de Desligamento'[is.na(sucupira$'Data de Desligamento')] <-
  "Atual"

# filter duplicated docentes (changes in details will we exhibited)
docentes <-
  sucupira[!duplicated(sucupira[, match("Nome Docente", colnames(sucupira)):match("Carga Horária PG (Semanal)", colnames(sucupira))]), ]
docentes <- docentes[order(docentes$"Nome Docente"),]

# generate tables
table.doc <- data.frame(matrix(NA, nrow = dim(docentes)[1], ncol = length(quadrienal.vigente)))
rownames(table.doc) <- NULL
table.doc <- cbind(docentes$`Nome Docente`, table.doc)
colnames(table.doc) <- c("Nome Docente", as.character(quadrienal.vigente))
for (i in 1:dim(docentes)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    sucupira.temp <-
      sucupira.list[as.character(quadrienal.vigente[j])][[1]]
    
    table.doc[i, j + 1] <-
      try(sucupira.temp$'Tipo vínculo'[match(table.doc$`Nome Docente`[i], sucupira.temp$`Nome Docente`)]
          , silent = TRUE)
  }
}
table.doc.2 <- table.doc

table.doc.long <- tidyr::gather(table.doc[, -1], "Ano", "Tipo vínculo", colnames(table.doc)[-1], factor_key=TRUE)

table.doc.long <- rbind(
  table.doc.long,
  data.frame(
    "Ano" = rep(paste0(min(quadrienal.vigente), "-", max(quadrienal.vigente)), times = dim(table.doc)[1]),
    "Tipo vínculo" = rep("Docentes", times = dim(table.doc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Docentes", na.rm = TRUE), digits = 0)
}

# print tables
table.1b <-
  gtsummary::tbl_summary(
    table.doc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(
    list(
      add_stat_1 ~ "**N (Quadriênio)**",
      all_stat_cols() ~ "**{level}**"
    )
  ) %>%  
  remove_row_type(variables = c('Tipo vínculo'), 
                  type = "level", level_value = ("Docentes")) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r regime-corpo-docente, eval = all(has.sucupira.files, knitr::is_html_output())}
# docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R")

# get years
source("Scripts/years-sucupira.R")
names(sucupira.list) <- as.character(anos)

# get docentes for the current period
sucupira <- sucupira.list[as.character(quadrienal.vigente)] %>%
  compact()
sucupira <- data.frame(do.call(dplyr::bind_rows, sucupira))
names(sucupira) <-
  names(sucupira.list[[as.character(max(as.numeric(names(sucupira.list))))]])

# recode
sucupira$'Data de Admissão' <-
  substr(as.Date(sucupira$'Data de Admissão', format = "%d/%m/%Y"), 1, 4)
sucupira$'Data de Desligamento' <-
  substr(as.Date(sucupira$'Data de Desligamento', format = "%d/%m/%Y"),
         1,
         4)
sucupira$'Data de Desligamento'[is.na(sucupira$'Data de Desligamento')] <-
  "Atual"

# filter duplicated docentes (changes in details will we exhibited)
docentes <-
  sucupira[!duplicated(sucupira[, match("Nome Docente", colnames(sucupira)):match("Carga Horária PG (Semanal)", colnames(sucupira))]), ]
docentes <- docentes[order(docentes$"Nome Docente"),]

# generate tables
table.doc <- data.frame(matrix(NA, nrow = dim(docentes)[1], ncol = length(quadrienal.vigente)))
rownames(table.doc) <- NULL
table.doc <- cbind(docentes$`Nome Docente`, table.doc)
colnames(table.doc) <- c("Nome Docente", as.character(quadrienal.vigente))
for (i in 1:dim(docentes)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    sucupira.temp <-
      sucupira.list[as.character(quadrienal.vigente[j])][[1]]
    
    table.doc[i, j + 1] <-
      try(sucupira.temp$'Regime de Trabalho'[match(table.doc$`Nome Docente`[i], sucupira.temp$`Nome Docente`)]
          , silent = TRUE)
  }
}
table.doc.3 <- table.doc

table.doc.long <- tidyr::gather(table.doc[, -1], "Ano", "Regime de Trabalho", colnames(table.doc)[-1], factor_key=TRUE)

table.doc.long <- rbind(
  table.doc.long,
  data.frame(
    "Ano" = rep(paste0(min(quadrienal.vigente), "-", max(quadrienal.vigente)), times = dim(table.doc)[1]),
    "Regime de Trabalho" = rep("Docentes", times = dim(table.doc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Docentes", na.rm = TRUE), digits = 0)
}

# print tables
table.1c <-
  gtsummary::tbl_summary(
    table.doc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(
    list(
      add_stat_1 ~ "**N (Quadriênio)**",
      all_stat_cols() ~ "**{level}**"
    )
  ) %>%  
  remove_row_type(variables = c('Regime de Trabalho'), 
                  type = "level", level_value = ("Docentes")) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r carga-horaria-corpo-docente, eval = all(has.sucupira.files, knitr::is_html_output())}
# docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R")

# get years
source("Scripts/years-sucupira.R")
names(sucupira.list) <- as.character(anos)

# get docentes for the current period
sucupira <- sucupira.list[as.character(quadrienal.vigente)] %>%
  compact()
sucupira <- data.frame(do.call(dplyr::bind_rows, sucupira))
names(sucupira) <-
  names(sucupira.list[[as.character(max(as.numeric(names(sucupira.list))))]])

# recode
sucupira$'Data de Admissão' <-
  substr(as.Date(sucupira$'Data de Admissão', format = "%d/%m/%Y"), 1, 4)
sucupira$'Data de Desligamento' <-
  substr(as.Date(sucupira$'Data de Desligamento', format = "%d/%m/%Y"),
         1,
         4)
sucupira$'Data de Desligamento'[is.na(sucupira$'Data de Desligamento')] <-
  "Atual"

# filter duplicated docentes (changes in details will we exhibited)
docentes <-
  sucupira[!duplicated(sucupira[, match("Nome Docente", colnames(sucupira)):match("Carga Horária PG (Semanal)", colnames(sucupira))]), ]
docentes <- docentes[order(docentes$"Nome Docente"),]

# generate tables
table.doc <- data.frame(matrix(NA, nrow = dim(docentes)[1], ncol = length(quadrienal.vigente)))
rownames(table.doc) <- NULL
table.doc <- cbind(docentes$`Nome Docente`, table.doc)
colnames(table.doc) <- c("Nome Docente", as.character(quadrienal.vigente))
for (i in 1:dim(docentes)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    sucupira.temp <-
      sucupira.list[as.character(quadrienal.vigente[j])][[1]]
    
    table.doc[i, j + 1] <-
      try(sucupira.temp$"Carga Horária PG (Semanal)"[match(table.doc$`Nome Docente`[i], sucupira.temp$`Nome Docente`)]
          , silent = TRUE)
  }
}
table.doc.4 <- table.doc

table.doc.long <- tidyr::gather(table.doc[, -1], "Ano", "Carga Horária PG (Semanal)", colnames(table.doc)[-1], factor_key=TRUE)

table.doc.long <- rbind(
  table.doc.long,
  data.frame(
    "Ano" = rep(paste0(min(quadrienal.vigente), "-", max(quadrienal.vigente)), times = dim(table.doc)[1]),
    "Carga Horária PG (Semanal)" = rep("Docentes", times = dim(table.doc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Docentes", na.rm = TRUE), digits = 0)
}

# print tables
table.1d <-
  gtsummary::tbl_summary(
    table.doc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(
    list(
      add_stat_1 ~ "**N (Quadriênio)**",
      all_stat_cols() ~ "**{level}**"
    )
  ) %>%  
  remove_row_type(variables = c('Carga Horária PG (Semanal)'), 
                  type = "level", level_value = ("Docentes")) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r dimensao-corpo-docente, eval = all(has.sucupira.files, knitr::is_html_output())}
table.all <- gtsummary::tbl_stack(
  list(
    table.1a,
    table.1b,
    table.1c,
    table.1d
  )
)
print(table.all)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<details>
<summary>Dimensão | Dados individuais</summary>
```{r dimensao-corpo-docente-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.doc.1, align = c("l", rep(
    "c", ncol(table.doc.1) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Vínculo | Dados individuais</summary>
```{r vinculacao-corpo-docente-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.doc.2, align = c("l", rep(
    "c", ncol(table.doc.2) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Regime de trabalho | Dados individuais</summary>
```{r regime-corpo-docente-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.doc.3, align = c("l", rep(
    "c", ncol(table.doc.3) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Carga horária PG | Dados individuais</summary>
```{r carga-horaria-corpo-docente-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.doc.4, align = c("l", rep(
    "c", ncol(table.doc.4) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<br>

### **1.2.2**

#### **Coerência acadêmica do Corpo Docente à proposta do PPG**

```{r coerencia-corpo-docente, eval = all(has.sucupira.files, knitr::is_html_output())}
# docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R")

# get years
source("Scripts/years-sucupira.R")
names(sucupira.list) <- as.character(anos)

# get docentes for the current period
sucupira <- sucupira.list[as.character(quadrienal.vigente)] %>%
  compact()
sucupira <- data.frame(do.call(dplyr::bind_rows, sucupira))
names(sucupira) <-
  names(sucupira.list[[as.character(max(as.numeric(names(sucupira.list))))]])

# recode
sucupira$'Data de Admissão' <-
  substr(as.Date(sucupira$'Data de Admissão', format = "%d/%m/%Y"), 1, 4)
sucupira$'Data de Desligamento' <-
  substr(as.Date(sucupira$'Data de Desligamento', format = "%d/%m/%Y"),
         1,
         4)
sucupira$'Data de Desligamento'[is.na(sucupira$'Data de Desligamento')] <-
  "Atual"

# filter duplicated docentes (changes in details will we exhibited)
docentes <-
  sucupira[!duplicated(sucupira[, match("Nome Docente", colnames(sucupira)):match("Área de Conhecimento Titulação", colnames(sucupira))]), ]
docentes <- docentes[order(docentes$"Nome Docente"),]

# generate tables
table.doc <- data.frame(matrix(NA, nrow = dim(docentes)[1], ncol = length(quadrienal.vigente)))
rownames(table.doc) <- NULL
table.doc <- cbind(docentes$`Nome Docente`, table.doc)
colnames(table.doc) <- c("Nome Docente", as.character(quadrienal.vigente))
for (i in 1:dim(docentes)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    sucupira.temp <-
      sucupira.list[as.character(quadrienal.vigente[j])][[1]]
    
    table.doc[i, j + 1] <-
      try(sucupira.temp$'Área de Conhecimento Titulação'[match(table.doc$`Nome Docente`[i], sucupira.temp$`Nome Docente`)]
          , silent = TRUE)
  }
}
table.doc.5 <- table.doc

table.doc.long <- tidyr::gather(table.doc[, -1], "Ano", "Área de Conhecimento Titulação", colnames(table.doc)[-1], factor_key=TRUE)

table.doc.long <- rbind(
  table.doc.long,
  data.frame(
    "Ano" = rep(paste0(min(quadrienal.vigente), "-", max(quadrienal.vigente)), times = dim(table.doc)[1]),
    "Área de Conhecimento Titulação" = rep("Docentes", times = dim(table.doc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Docentes", na.rm = TRUE), digits = 0)
}

# print tables
table.1 <-
  gtsummary::tbl_summary(
    table.doc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(
    list(
      add_stat_1 ~ "**N (Quadriênio)**",
      all_stat_cols() ~ "**{level}**"
    )
  ) %>%  
  remove_row_type(variables = c('Área de Conhecimento Titulação'), 
                  type = "level", level_value = ("Docentes")) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))

print(table.1)

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<details>
<summary>Área de conhecimento titulação | Dados individuais</summary>
```{r coerencia-corpo-docente-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.doc.5, align = c("l", rep(
    "c", ncol(table.doc.5) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<br>

### **1.2.3**

#### **Estabilidade do corpo docente permanente**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **1.2.4**

#### **Percentual de docentes permanentes com dedicação exclusiva ao PPG**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **1.2.5**

#### **Capacidade de captação de recursos** {.tabset}

```{r auto-financiadores-docente-ano, eval = all(has.financiadores, knitr::is_html_output())}
# this chunk requires additional data that may not be available
financiadores.raw <-
  readxl::read_excel("PPG/Financiadores.xlsx", sheet = "financiadores")

options(scipen = 10)

financiadores.raw <-
  readxl::read_excel("PPG/Financiadores.xlsx", sheet = "financiadores")

# dplyr::select variables to display, by AGENCIA & ANO
financiadores <-
  financiadores.raw %>% dplyr::select("Proponente", "Ano", "Total")

# drop rows with empty cells
financiadores <- financiadores[complete.cases(financiadores),]

financiadores <-
  financiadores[order(financiadores$Proponente, decreasing = TRUE),]

# filtra no período
financiadores <- 
  financiadores[financiadores$Ano %in% quadrienal.vigente, ]

table.2 <-
  tbl_summary(
    financiadores,
    by = "Ano",
    type = list(all_continuous() ~ "continuous"),
    statistic = list(all_continuous() ~ c("R$ {sum}")),
    missing = "no",
    digits = "Total" ~ 2,
    sort = all_categorical() ~ "frequency"
  ) %>%
  add_overall(last = TRUE,
              col_label = "Total") %>%
  modify_header(label = "**Ano**") %>%
  modify_footnote(update = everything() ~ NA) %>%
  bold_labels()
# print table
print(table.2)

cat('\n\n')
cat(
  "*Fontes:* [**CAPES**](https://www.gov.br/capes/pt-br), [**CNPq**](https://www.gov.br/cnpq/pt-br), [**FAPERJ**](http://www.faperj.br), **UNISUAM**"
)
cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a><br>')
```

<br>

### **1.3.1**

#### **Adequação da proposta ao Plano Institucional da IES** {.tabset}

```{r planejamento, eval = all(has.planejamento, knitr::is_html_output())}
# initialize all sheets
abas <- readxl::excel_sheets("PPG/Planejamento estratégico.xlsx")

# display each sheet in a tab
for (i in 1:length(abas)) {
  cat('\n\n<!-- -->\n\n')
  cat(paste0('##### **', abas[i], '**'))
  cat('\n\n<!-- -->\n\n')
  planejamento <-
    readxl::read_excel("PPG/Planejamento estratégico.xlsx",
               sheet = abas[i],
               col_types = c("text"))
  
  cat(
    paste(
      '<iframe src="',
      planejamento[1],
      '/preview" style=\"width:100%; height:600px; border:2px solid black;"></iframe>',
      sep = ""
    )
  )
  
  # print end of tab rows
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a><br>')
}
```

<br>

### **1.3.2**

#### **Adequação do planejamento**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **1.4.1**

#### **Adequação dos processos e procedimentos utilizados para a autoavaliação do Programa**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

```{=latex}
\newpage
```

## **2. Formação** {#formacao .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

### **2.1.1**

#### **Coerência do produto final**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.1.2**

#### **Qualidade do produto final**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.2.1**

#### **Produção do corpo discente em eventos científicos**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.2.2**

#### **Produção bibliográfica dos discentes/egressos – Acadêmico**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.3.1**

#### **Atuação dos Egressos**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.3.2**

#### **Egressos de destaque na sociedade**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.4.1**

#### **Produção bibliográfica total do Programa – Acadêmico**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.5.1**

#### **Atividades de ensino nas disciplinas do PPG**

```{r turmas-docentes-2024, eval = all(has.sucupira.files, knitr::is_html_output())}
# load custom function
source("Scripts/get-initials.R", local = knitr::knit_global())

# disciplinas
sheet <- "Disciplinas"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# get years
source("Scripts/years-sucupira.R", local = knitr::knit_global())
names(sucupira.list) <- as.character(anos)

# bind all sheets
periodos <-
  names(sucupira.list)[na.omit(match(c(2021:2024), names(sucupira.list)))]
periodo <- as.character(seq(min(periodos), max(periodos), by = 1))
disciplinas.raw <-
  do.call(rbind.data.frame, sucupira.list[periodos])
disciplinas.raw <-
  disciplinas.raw[is.na(disciplinas.raw$`Data de fim`),]

# turmas
sheet <- "Turmas"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# get years
source("Scripts/years-sucupira.R", local = knitr::knit_global())
names(sucupira.list) <- as.character(anos)

# bind all sheets
periodos <-
  names(sucupira.list)[na.omit(match(c(2021:2024), names(sucupira.list)))]
periodo <- as.character(seq(min(periodos), max(periodos), by = 1))
turmas.raw <- do.call(rbind.data.frame, sucupira.list[periodos])

if (dim(disciplinas.raw)[1] != 0) {
  # select level
  course.level <- "Mestrado"
  disciplinas.msc <-
    disciplinas.raw[stringr::str_detect(disciplinas.raw$`Nível do Curso`, course.level), ]
  
  disciplinas.msc <-
    disciplinas.raw[course.level,]
  table.msc <-
    cbind(
      disciplinas.msc$`Nome da Disciplina`,
      disciplinas.msc$`Indicadora de disciplina obrigatória`,
      disciplinas.msc$`Quantidade de créditos`,
      disciplinas.msc$`Carga Horária`
    )
  colnames(table.msc) <- c("Disciplina", "Obrigatória", "CR", "CH")
  
  course.level <- "Doutorado"
  disciplinas.dsc <-
    disciplinas.raw[stringr::str_detect(disciplinas.raw$`Nível do Curso`, course.level), ]
  disciplinas.dsc <-
    disciplinas.raw[course.level,]
  table.dsc <-
    cbind(
      disciplinas.dsc$`Nome da Disciplina`,
      disciplinas.dsc$`Indicadora de disciplina obrigatória`,
      disciplinas.dsc$`Quantidade de créditos`,
      disciplinas.dsc$`Carga Horária`
    )
  colnames(table.dsc) <- c("Disciplina", "Obrigatória", "CR", "CH")
  
  table <-
    merge(
      table.msc,
      table.dsc,
      by = "Disciplina",
      all.x = TRUE,
      all.y = TRUE
    )
  colnames(table) <-
    c(
      "Disciplina",
      "Obrigatória (MA)",
      "CR (MA)",
      "CH (MA)",
      "Obrigatória (DA)",
      "CR (DA)",
      "CH (DA)"
    )
  
  # build a cross table DISCIPLINA vs. DOCENTE
  cross.table.turmas <-
    as.matrix(table(
      initials(turmas.raw$`Nome da Disciplina`),
      initials(turmas.raw$`Nome do responsável`)
    ))
  Responsável <- colSums(cross.table.turmas)
  Responsável[Responsável > 0] <- "✅"
  Responsável[Responsável == 0] <- ""
  turmas.docentes <- rbind(Responsável, cross.table.turmas)
  turmas.docentes[turmas.docentes > 0] <- "✔"
  turmas.docentes[turmas.docentes == 0] <- ""
  print(
    kableExtra::kable(turmas.docentes, align = c("l", rep(
      "c", ncol(turmas.docentes) - 2
    ), "r")) %>% kableExtra::kable_styling(
      bootstrap_options = c("striped", "hover", "condensed", "responsive"),
      full_width = T,
      position = "center"
    ) %>% kableExtra::scroll_box(width = "100%")
  )
  
  # line break
  cat("  \n")
  cat("  \n")
  
  legenda.turma <-
    unique(cbind(
      initials(turmas.raw$`Nome da Disciplina`),
      turmas.raw$`Nome da Disciplina`
    ))
  legenda.turma <- legenda.turma[order(legenda.turma[, 1]),]
  cat(paste(
    "*",
    legenda.turma[, 1],
    ": ",
    lapply(legenda.turma[, 2], str_to_title),
    "*",
    sep = "",
    collapse = "; "
  ))
  
  # line break
  cat("  \n")
  cat("  \n")
  
  legenda.doc <-
    unique(cbind(
      initials(turmas.raw$`Nome do responsável`),
      turmas.raw$`Nome do responsável`
    ))
  legenda.doc <- legenda.doc[order(legenda.doc[, 1]),]
  cat(paste(
    "*",
    legenda.doc[, 1],
    ": ",
    lapply(legenda.doc[, 2], str_to_title),
    "*",
    sep = "",
    collapse = "; "
  ))
}

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

### **2.5.2**

#### **Responsabilidade por PP/PTT**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.5.3**

#### **Orientação no PPG**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.5.4**

#### **Titulação no PPG**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **2.5.5**

#### **Orientação na graduação**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

```{=latex}
\newpage
```

## **3. Impacto na sociedade** {#impacto .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

### **3.1.1**

#### **Produção bibliográfica indicada dos DP – Acadêmico**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **3.1.2**

#### **Produção do Programa**

```{r 3-1-2-data, eval = all(has.sucupira.files, knitr::is_html_output())}
# Produções - Detalhes
sheet <- "Produções - Detalhes"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# get years
source("Scripts/years-sucupira.R", local = knitr::knit_global())
names(sucupira.list) <- as.character(anos)

# get data for the current period
sucupira <- sucupira.list[as.character(quadrienal.vigente)] %>%
  plyr::compact()
for(i in 1:length(sucupira)){
  sucupira[[i]] <- cbind(
    "Anos" = rep(quadrienal.vigente[i], times = dim(sucupira[[i]])[1]),
    sucupira[[i]]
  )
}
sucupira.df <- data.frame(do.call(dplyr::bind_rows, sucupira))
names(sucupira.df) <-
  names(sucupira[[as.character(max(as.numeric(quadrienal.vigente)))]])

sucupira.df <-
  sucupira.df %>% dplyr::select(
    "Anos",
    "Nome da Produção",
    "Produção vinculada a TCC concluído",
    "Tipo de Produção",
    "Subtipo de Produção",
    "Área de Concentração",
    "Linha de Pesquisa",
    "Projeto",
    "Categoria do Autor Principal"
  )
```

```{r 3-1-2-ac, eval = all(has.sucupira.files, knitr::is_html_output())}
table.ac <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome da Produção`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.ac) <- NULL
table.ac <- cbind(unique(sucupira.df$`Nome da Produção`), table.ac)
colnames(table.ac) <-
  c("Nome da Produção", as.character(quadrienal.vigente))
for (i in 1:dim(table.ac)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.ac[i, j + 1] <-
      try(
        data$`Área de Concentração`[match(table.ac$`Nome da Produção`[i],data$`Nome da Produção`)]
          , silent = TRUE)
  }
}

table.ac.long <-
  tidyr::gather(table.ac[, -1],
                "Ano",
                "Área de Concentração",
                colnames(table.ac)[-1],
                factor_key = TRUE)

table.ac.long <- rbind(
  table.ac.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.ac)[1]),
    "Área de Concentração" = rep("Produção", times = dim(table.ac)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Produção", na.rm = TRUE), digits = 0)
}

colnames(table.ac.long) <- c("Ano", "Produção por Área de Concentração")

# print tables
table.ac.gt <-
  gtsummary::tbl_summary(
    table.ac.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0,
    sort = all_categorical() ~ "frequency"
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Produção por Área de Concentração'),
    type = "level",
    level_value = ("Produção")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 3-1-2-lp, eval = all(has.sucupira.files, knitr::is_html_output())}
table.lp <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome da Produção`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.lp) <- NULL
table.lp <- cbind(unique(sucupira.df$`Nome da Produção`), table.lp)
colnames(table.lp) <-
  c("Nome da Produção", as.character(quadrienal.vigente))
for (i in 1:dim(table.lp)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.lp[i, j + 1] <-
      try(
        data$`Linha de Pesquisa`[match(table.lp$`Nome da Produção`[i],data$`Nome da Produção`)]
          , silent = TRUE)
  }
}

table.lp.long <-
  tidyr::gather(table.lp[, -1],
                "Ano",
                "Linha de Pesquisa",
                colnames(table.lp)[-1],
                factor_key = TRUE)

table.lp.long <- rbind(
  table.lp.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.lp)[1]),
    "Linha de Pesquisa" = rep("Produção", times = dim(table.lp)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Produção", na.rm = TRUE), digits = 0)
}

colnames(table.lp.long) <- c("Ano", "Produção por Linha de Pesquisa")

# print tables
table.lp.gt <-
  gtsummary::tbl_summary(
    table.lp.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0,
    sort = all_categorical() ~ "frequency"
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Produção por Linha de Pesquisa'),
    type = "level",
    level_value = ("Produção")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 3-1-2-producao, eval = all(has.sucupira.files, knitr::is_html_output())}
table.prd <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome da Produção`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.prd) <- NULL
table.prd <- cbind(unique(sucupira.df$`Nome da Produção`), table.prd)
colnames(table.prd) <-
  c("Nome da Produção", as.character(quadrienal.vigente))
for (i in 1:dim(table.prd)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.prd[i, j + 1] <-
      try(
        data$`Tipo de Produção`[match(table.prd$`Nome da Produção`[i],data$`Nome da Produção`)]
          , silent = TRUE)
  }
}

table.prd.long <-
  tidyr::gather(table.prd[, -1],
                "Ano",
                "Nome da Produção",
                colnames(table.prd)[-1],
                factor_key = TRUE)

table.prd.long <- rbind(
  table.prd.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.prd)[1]),
    "Nome da Produção" = rep("Produção", times = dim(table.prd)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Produção", na.rm = TRUE), digits = 0)
}

colnames(table.prd.long) <- c("Ano", "Produção por tipo")

# print tables
table.prd.gt <-
  gtsummary::tbl_summary(
    table.prd.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0,
    sort = all_categorical() ~ "frequency"
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Produção por tipo'),
    type = "level",
    level_value = ("Produção")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 3-1-2-autor, eval = all(has.sucupira.files, knitr::is_html_output())}
table.aut <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome da Produção`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.aut) <- NULL
table.aut <- cbind(unique(sucupira.df$`Nome da Produção`), table.aut)
colnames(table.aut) <-
  c("Nome da Produção", as.character(quadrienal.vigente))
for (i in 1:dim(table.aut)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.aut[i, j + 1] <-
      try(
        data$`Categoria do Autor Principal`[match(table.aut$`Nome da Produção`[i],data$`Nome da Produção`)]
          , silent = TRUE)
  }
}

table.aut.long <-
  tidyr::gather(table.aut[, -1],
                "Ano",
                "Categoria do Autor Principal",
                colnames(table.aut)[-1],
                factor_key = TRUE)

table.aut.long <- rbind(
  table.aut.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.aut)[1]),
    "Categoria do Autor Principal" = rep("Produção", times = dim(table.aut)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Produção", na.rm = TRUE), digits = 0)
}

colnames(table.aut.long) <- c("Ano", "Categoria do Autor Principal")

# print tables
table.aut.gt <-
  gtsummary::tbl_summary(
    table.aut.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0,
    sort = all_categorical() ~ "frequency"
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Categoria do Autor Principal'),
    type = "level",
    level_value = ("Produção")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 3-1-2-tcc, eval = all(has.sucupira.files, knitr::is_html_output())}
table.tcc <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome da Produção`)),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.tcc) <- NULL
table.tcc <- cbind(unique(sucupira.df$`Nome da Produção`), table.tcc)
colnames(table.tcc) <-
  c("Nome da Produção", as.character(quadrienal.vigente))
for (i in 1:dim(table.tcc)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.tcc[i, j + 1] <-
      try(
        data$`Produção vinculada a TCC concluído`[match(table.tcc$`Nome da Produção`[i],data$`Nome da Produção`)]
          , silent = TRUE)
  }
}

table.tcc.long <-
  tidyr::gather(table.tcc[, -1],
                "Ano",
                "Produção vinculada a TCC concluído",
                colnames(table.tcc)[-1],
                factor_key = TRUE)

table.tcc.long <- rbind(
  table.tcc.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.tcc)[1]),
    "Produção vinculada a TCC concluído" = rep("Produção", times = dim(table.tcc)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Produção", na.rm = TRUE), digits = 0)
}

colnames(table.tcc.long) <- c("Ano", "Produção vinculada a TCC concluído")

# print tables
table.tcc.gt <-
  gtsummary::tbl_summary(
    table.tcc.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0,
    sort = all_categorical() ~ "frequency"
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Produção vinculada a TCC concluído'),
    type = "level",
    level_value = ("Produção")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 3-1-2-bibliografica, eval = all(has.sucupira.files, knitr::is_html_output())}
table.bib <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome da Produção`[sucupira.df$`Tipo de Produção` == "BIBLIOGRÁFICA"])),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.bib) <- NULL
table.bib <- cbind(unique(sucupira.df$`Nome da Produção`[sucupira.df$`Tipo de Produção` == "BIBLIOGRÁFICA"]), table.bib)
colnames(table.bib) <-
  c("Nome da Produção", as.character(quadrienal.vigente))
for (i in 1:dim(table.bib)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.bib[i, j + 1] <-
      try(
        data$`Subtipo de Produção`[match(table.bib$`Nome da Produção`[i],data$`Nome da Produção`)]
          , silent = TRUE)
  }
}

table.bib.long <-
  tidyr::gather(table.bib[, -1],
                "Ano",
                "Subtipo de Produção",
                colnames(table.bib)[-1],
                factor_key = TRUE)

table.bib.long <- rbind(
  table.bib.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.bib)[1]),
    "Subtipo de Produção" = rep("Produção", times = dim(table.bib)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Produção", na.rm = TRUE), digits = 0)
}

colnames(table.bib.long) <- c("Ano", "Produção bibliográfica")

# print tables
table.bib.gt <-
  gtsummary::tbl_summary(
    table.bib.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0,
    sort = all_categorical() ~ "frequency"
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Produção bibliográfica'),
    type = "level",
    level_value = ("Produção")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

```{r 3-1-2-tecnica, eval = all(has.sucupira.files, knitr::is_html_output())}
table.tec <-
  data.frame(matrix(
    NA,
    nrow = length(unique(sucupira.df$`Nome da Produção`[sucupira.df$`Tipo de Produção` == "TÉCNICA"])),
    ncol = length(quadrienal.vigente)
  ))
rownames(table.tec) <- NULL
table.tec <- cbind(unique(sucupira.df$`Nome da Produção`[sucupira.df$`Tipo de Produção` == "TÉCNICA"]), table.tec)
colnames(table.tec) <-
  c("Nome da Produção", as.character(quadrienal.vigente))
for (i in 1:dim(table.tec)[1]) {
  for (j in 1:length(quadrienal.vigente)) {
    data <- sucupira.df[sucupira.df$Anos == quadrienal.vigente[j], ]
    table.tec[i, j + 1] <-
      try(
        data$`Subtipo de Produção`[match(table.tec$`Nome da Produção`[i],data$`Nome da Produção`)]
          , silent = TRUE)
  }
}

table.tec.long <-
  tidyr::gather(table.tec[, -1],
                "Ano",
                "Subtipo de Produção",
                colnames(table.tec)[-1],
                factor_key = TRUE)

table.tec.long <- rbind(
  table.tec.long,
  data.frame(
    "Ano" = rep(paste0(
      min(quadrienal.vigente), "-", max(quadrienal.vigente)
    ), times = dim(table.tec)[1]),
    "Subtipo de Produção" = rep("Produção", times = dim(table.tec)[1]),
    check.names = FALSE
  )
)

my_N <- function(data, ...) {
  style_number(sum(data == "Produção", na.rm = TRUE), digits = 0)
}

colnames(table.tec.long) <- c("Ano", "Produção técnica")

# print tables
table.tec.gt <-
  gtsummary::tbl_summary(
    table.tec.long,
    by = "Ano",
    statistic = list(all_categorical() ~ "{n}"),
    missing = "no",
    digits = everything() ~ 0,
    sort = all_categorical() ~ "frequency"
  ) %>%
  gtsummary::modify_header(label = "", all_stat_cols() ~ "**{level}**") %>%
  gtsummary::modify_footnote(all_stat_cols() ~ NA) %>%
  gtsummary::bold_labels() %>%
  gtsummary::add_stat(fns = all_categorical() ~ my_N) %>%
  gtsummary::modify_header(list(
    add_stat_1 ~ "**N (Quadriênio)**",
    all_stat_cols() ~ "**{level}**"
  )) %>%
  remove_row_type(
    variables = c('Produção técnica'),
    type = "level",
    level_value = ("Produção")
  ) %>%
  modify_column_hide(columns = paste0("stat_", as.character(length(quadrienal.vigente) + 1)))
```

<br>

```{r 3-1-2-list-tables, eval = all(has.sucupira.files, knitr::is_html_output())}
# list all tables
table.all <-
  list(table.ac.gt,
       table.lp.gt,
       table.prd.gt,
       table.aut.gt,
       table.tcc.gt,
       table.bib.gt,
       table.tec.gt
  )

# drop empty elements from list
table.all <- table.all[lapply(table.all, length) > 0]

# print all tables stacked
print(gtsummary::tbl_stack(table.all))

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

<details>
<summary>Produção por Área de Concentração | Dados individuais</summary>
```{r producao-ac-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.ac, align = c("l", rep(
    "c", ncol(table.ac) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Produção por Linha de Pesquisa | Dados individuais</summary>
```{r producao-lp-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.lp, align = c("l", rep(
    "c", ncol(table.lp) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Produção por tipo | Dados individuais</summary>
```{r producao-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.prd, align = c("l", rep(
    "c", ncol(table.prd) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Categoria do Autor Principal | Dados individuais</summary>
```{r autor-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.aut, align = c("l", rep(
    "c", ncol(table.aut) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Produção vinculada à TCC | Dados individuais</summary>
```{r tecnica-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.tcc, align = c("l", rep(
    "c", ncol(table.tcc) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Produção bibliográfica | Dados individuais</summary>
```{r bibliografica-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.bib, align = c("l", rep(
    "c", ncol(table.bib) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<details>
<summary>Produção técnica | Dados individuais</summary>
```{r tecnioca-detalhes, eval = all(has.sucupira.files, knitr::is_html_output())}
options(knitr.kable.NA = '')
print(
  kableExtra::kable(table.tec, align = c("l", rep(
    "c", ncol(table.tec) - 2
  ), "r")) %>% kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = T,
    position = "center"
  ) %>% kableExtra::scroll_box(width = "100%")
)
```
</details>

<br>

### **3.2.1**

#### **Avaliação quantitativa dos impactos do PPG**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **3.2.2**

#### **Avaliação qualitativa dos impactos do PPG**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **3.3.1**

#### **Visibilidade**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

### **3.3.2**

#### **Internacionalização e Inserção**

*Em construção*

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

```{=latex}
\DisableFootNotes
```

```{r relatorio-quadrienal, eval = knitr::is_html_output()}
cat("## **Relatório quadrienal** {#relatorio-quadrienal}")
cat('\n\n')
cat('<!--script for generating HORIZONTAL LINE-->')
cat('\n\n')
cat('<hr style="height:2px;border-width:0;color:black;background-color:black">')
cat('\n\n')
cat(
  paste0(
    '<iframe src=\"',
    'autoavaliacao.pdf',
    '\" style=\"width:100%; height:600px; border:2px solid black;\"></iframe>'
  )
)
cat('\n\n')
```
