---
title: Destaques
output:
  html_document:
    toc: true
    toc_float: true
    css:
      - ./CSS/generic.css
      - ./CSS/logo-above-toc.css
      - ./CSS/main-color.css
      - ./CSS/narrow-margins.css
      - ./CSS/responsive.css
---

<!--set up-->
```{r setup, include = FALSE, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', out.width = "100%", results = "hide"}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.align = 'center',
  results = "asis",
  include = TRUE,
  out.width = "100%",
  knitr.kable.NA = '',
  knitr.table.format = ifelse(knitr::is_html_output(), "html", "latex"),
  webshot = "webshot",
  dev = "png"
)
```

<!--load caches-->
```{r load-caches, echo = FALSE, include = FALSE}
folders <- list.dirs(file.path("cache/"), full.names = FALSE, recursive = FALSE)
for(folder in folders){
    knitr::load_cache(label = folder, path = paste0(file.path("cache", folder), "/"))
}
```

<!--script for inserting LOGO ABOVE THE TOC-->
```{js}
$(document).ready(function() {
  $('#TOC').parent().prepend('<div id=\"nav_logo\"><img src="PPG/Images/logo-programa.png"></div>');
  });
```

<!--script for sharing-->
<p align="right">
```{r share}
home <- metadata$repository_url
source("Scripts/social-media-sharing.R", local = knitr::knit_global())
```
</p>

<!--script for generating ALTMETRIC badges-->
<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>

<!--script for generating multiple DIMENSIONS badges-->
<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<!--script for generating multiple PLUMX badges-->
<script type="text/javascript" src="//cdn.plu.mx/widget-all.js"></script>

<br>

## **Egressos** {#egressos-destaque .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !has.sucupira.files}
cat('<br>')
```

### **Formação continuada** {#formacao-continuada}

```{r formacao-continuada, eval = has.sucupira.files}
# Discentes
sheet <- "Discentes"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())
# get data
discentes <- dplyr::select(
  sucupira.raw,
  `Identificador da Pessoa`,
  `Nome Discente`,
  `Nível Discente`,
  `Situação Discente`,
  `Data Matrícula`,
  `Data Situação`
)
colnames(discentes)[2] <- "Nome"
colnames(discentes)[3] <- "Nível"
colnames(discentes)[4] <- "Situação"

# Egressos
sheet <- "Egressos"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())
# get data
egressos <- dplyr::select(
  sucupira.raw,
  `Identificador da Pessoa do Egresso`,
  `Nome do Egresso`,
  `Nível Titulação`,
  `Ano Titulação`
)
colnames(egressos)[1] <- "Identificador da Pessoa"
colnames(egressos)[2] <- "Nome"
colnames(egressos)[3] <- "Nível"
try(egressos$Situação <- "EGRESSO", silent = TRUE)

# Pós-Doc
sheet <- "Pós-Doc"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())
# get data
posdoc <- dplyr::select(
  sucupira.raw,
  `Identificador da Pessoa`,
  `Pós-Doc Nome`,
  `Vínculo Início`,
  `Vínculo Fim`
)
colnames(posdoc)[2] <- "Nome"
try(posdoc$Situação <- "PÓS-DOC", silent = TRUE)

# Docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())
# get data
docentes <- dplyr::select(
  sucupira.raw,
  `Identificador da Pessoa`,
  `Nome Docente`,
  `Data de Admissão`,
  `Data de Desligamento`
)
colnames(docentes)[2] <- "Nome"
try(docentes$Situação <- "DOCENTE", silent = TRUE)

# bind all data by "Identificador da Pessoa"
formacao.continuada <- dplyr::bind_rows(
  discentes,
  egressos,
  posdoc,
  docentes
)

# format names
formacao.continuada$Nome <- tools::toTitleCase(tolower(formacao.continuada$Nome))

# remove duplicates
formacao.continuada <- formacao.continuada %>%
  dplyr::distinct()

# sort by "Identificador da Pessoa"
formacao.continuada <- formacao.continuada %>%
  dplyr::arrange(`Identificador da Pessoa`)

# create table to fill with start-end year for each situation
table <- data.frame(
  "Nome" = NA,
  Bacharelado = NA,
  "Mestrado" = NA,
  "Doutorado" = NA,
  "Pós-Doc" = NA,
  "Docente" = NA,
  check.names = FALSE
)

ID <- unique(formacao.continuada$`Identificador da Pessoa`)
for (i in 1:length(ID)) {
  # select data by ID
  data <- formacao.continuada %>%
    dplyr::filter(`Identificador da Pessoa` == ID[i])
  # get name
  table[i, "Nome"] <- data$Nome[1]
  # get year of start and end for discentes equal to bacharelado
  table[i, "Bacharelado"] <- min(data$`Data Matrícula`[data$Nível == "Bacharelado"], na.rm = TRUE)
  table[i, "Bacharelado"] <- format(as.Date(table[i, "Bacharelado"], format = "%d/%m/%Y"), "%Y")
  # get year of start and end for discentes equal to mestrado
  table[i, "Mestrado"] <- min(data$`Data Matrícula`[data$Nível == "Mestrado"], na.rm = TRUE)
  table[i, "Mestrado"] <- format(as.Date(table[i, "Mestrado"], format = "%d/%m/%Y"), "%Y")
  # get year of start and end for discentes equal to doutorado
  table[i, "Doutorado"] <- min(data$`Data Matrícula`[data$Nível == "Doutorado"], na.rm = TRUE)
  table[i, "Doutorado"] <- format(as.Date(table[i, "Doutorado"], format = "%d/%m/%Y"), "%Y")
  # get year of start and end for pós-doc
  table[i, "Pós-Doc"] <- min(data$`Vínculo Início`, na.rm = TRUE)
  table[i, "Pós-Doc"] <- format(as.Date(table[i, "Pós-Doc"], format = "%d/%m/%Y"), "%Y")
  # get year of start and end for docentes
  table[i, "Docente"] <- min(data$`Data de Admissão`, na.rm = TRUE)
  table[i, "Docente"] <- format(as.Date(table[i, "Docente"], format = "%d/%m/%Y"), "%Y")
}

# add last colum with total number of years
table$Atuações <- apply(table, 1, function(x) {
  sum(!is.na(x)) - 1
})

# add last column with the lowest and higher levels of education. Paste levels
table$Formação <- apply(table, 1, function(x) {
  # drop first and last columns
  x <- x[-c(1, length(x))]
  # get lower column with data
  lower <- which(!is.na(x))[1]
  # get higher column with data
  higher <- which(!is.na(x))[length(which(!is.na(x)))]
  if(length(which(!is.na(x))) == 1) {
    return(names(x)[lower])
  } else {
    return(paste(names(x)[lower], names(x)[higher], sep = " - "))
  }
})

# sort by iniciacao científica, mestrado, doutorado, pós-doc, docente e nome
table.continuada <- table %>%
  dplyr::arrange(
    `Bacharelado`,
    `Mestrado`,
    `Doutorado`,
    `Pós-Doc`,
    `Docente`,
    Nome
  )

source("Scripts/table-with-buttons.R", local = knitr::knit_global())
create_dt(table.continuada, title = "Pessoas - Formação continuada")

source("Scripts/fonte-sucupira.R", local = knitr::knit_global())
```

<br>

### **Egressos de destaque**

```{r egressos-destaque, eval = has.destaques}
egressos.destaque <-
  readxl::read_excel("PPG/Destaques.xlsx",
             sheet = 1,
             col_types = c("text"))

Abrir <- matrix(NA, nrow = dim(egressos.destaque)[1])
colnames(Abrir) <- "Abrir"
# add hyperlinks
for (i in 1:dim(egressos.destaque)[1]) {
  if (!is.na(egressos.destaque[i, ncol(egressos.destaque)])) {
    Abrir[i] <-
      paste0('<a href="',
             egressos.destaque[i, ncol(egressos.destaque)],
             '" target="_blank"',
             '>',
             # fontawesome icon
             fontawesome::fa("up-right-from-square"),
             '</a>')
  }
}
egressos.destaque <- cbind(egressos.destaque[,-ncol(egressos.destaque)], Abrir)

# ordering by dates & titles
egressos.destaque <-
  egressos.destaque[order(
    egressos.destaque[, 1],
    egressos.destaque[, 2],
    decreasing = FALSE
  ),]

# print tables
source("Scripts/table-with-buttons.R", local = knitr::knit_global())
create_dt(egressos.destaque, title = "Destaques - Egressos")

# Print end of tab rows
cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
```

<br>

## **Dissertações/Teses** {#TCC-destaque .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !has.sucupira.files}
cat('<br>')
```

<br>

## **Engajamento com a produção** {#destaque-altmetric .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !has.sucupira.files}
cat('<br>')
```

```{r destaque-altmetric, eval = has.sucupira.files}
# Check if there are DOIs
if (sjmisc::is_empty(metricas_all)) {
  cat('\n')
  cat('*Sem produção para exibir*')
  cat('\n')
} else {
  # available years of publication
  years <- sort(unique(na.omit(metricas_all$"Ano da Produção")), decreasing = TRUE)
  for (year in 1:length(years)) {
    metricas_all_sort <- metricas_all[metricas_all$"Ano da Produção" == years[year], ]
    
    # Sort columns by Altmetric
    ordering <-
      order(as.numeric(metricas_all_sort$altmetric_score),
            decreasing = TRUE)
    metricas_all_sort <- metricas_all_sort[ordering, ]
    # drop rows with NA in Altmetric
    metricas_all_sort <- metricas_all_sort[!is.na(metricas_all_sort$altmetric_score), ]
    
    # get top 10 unique IDs
    uniqueID <- unique(metricas_all_sort$"ID da Produção")
    top <- min(length(uniqueID), 10, na.rm = TRUE)
    uniqueID_top <- uniqueID[1:top]
    metricas_all_sort_top <- metricas_all_sort[metricas_all_sort$"ID da Produção" %in% uniqueID_top, ]
    
    # Check for empty data
    if (!sjmisc::is_empty(metricas_all_sort_top)) {
      # print tab header
      cat('\n\n<!-- -->\n\n')
      cat("### **", as.character(years[year]), "**", "\n", sep = "")
      
      # print table of papers with/without badges
      source("Scripts/table-with-badges.R", local = knitr::knit_global())
      table.with.badges(
        show.Altmetric = TRUE,
        show.Dimensions = TRUE,
        show.PlumX = TRUE,
        show.CiteScore = TRUE,
        show.SJR = TRUE,
        show.Qualis = TRUE,
        metricas_all_produtos = metricas_all_sort_top
      )
    }
  }
}
```

<br>

## **Citações recentes do periódico** {#destaque-citescore .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !has.sucupira.files}
cat('<br>')
```

```{r destaque-citescore, eval = has.sucupira.files}
# Check if there are DOIs
if (sjmisc::is_empty(metricas_all)) {
  cat('\n')
  cat('*Sem produção para exibir*')
  cat('\n')
} else {
  # available years of publication
  years <- sort(unique(na.omit(metricas_all$"Ano da Produção")), decreasing = TRUE)
  for (year in 1:length(years)) {
    metricas_all_sort <- metricas_all[metricas_all$"Ano da Produção" == years[year], ]
    
    # Sort columns by CiteScore
    ordering <-
      order(as.numeric(metricas_all_sort$CiteScore),
            decreasing = TRUE)
    metricas_all_sort <- metricas_all_sort[ordering, ]
    # drop rows with NA in CiteScore
    metricas_all_sort <- metricas_all_sort[!is.na(metricas_all_sort$CiteScore), ]
    
    # get top 10 unique IDs
    uniqueID <- unique(metricas_all_sort$"ID da Produção")
    top <- min(length(uniqueID), 10, na.rm = TRUE)
    uniqueID_top <- uniqueID[1:top]
    metricas_all_sort_top <- metricas_all_sort[metricas_all_sort$"ID da Produção" %in% uniqueID_top, ]
    
    # Check for empty data
    if (!sjmisc::is_empty(metricas_all_sort_top)) {
      # print tab header
      cat('\n\n<!-- -->\n\n')
      cat("### **", as.character(years[year]), "**", "\n", sep = "")
      
      # print table of papers with/without badges
      source("Scripts/table-with-badges.R", local = knitr::knit_global())
      table.with.badges(
        show.Altmetric = TRUE,
        show.Dimensions = TRUE,
        show.PlumX = TRUE,
        show.CiteScore = TRUE,
        show.SJR = TRUE,
        show.Qualis = TRUE,
        metricas_all_produtos = metricas_all_sort_top
      )
    }
  }
}
```

<br>

## **Prestígio do periódico** {#destaque-sjr .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !has.sucupira.files}
cat('<br>')
```

```{r destaque-sjr, eval = has.sucupira.files}
# Check if there are DOIs
if (sjmisc::is_empty(metricas_all)) {
  cat('\n')
  cat('*Sem produção para exibir*')
  cat('\n')
} else {
  # available years of publication
  years <- sort(unique(na.omit(metricas_all$"Ano da Produção")), decreasing = TRUE)
  for (year in 1:length(years)) {
    metricas_all_sort <- metricas_all[metricas_all$"Ano da Produção" == years[year], ]
    
    # Sort columns by SJR
    ordering <-
      order(as.numeric(metricas_all_sort$SJR),
            decreasing = TRUE)
    metricas_all_sort <- metricas_all_sort[ordering, ]
    # drop rows with NA in SJR
    metricas_all_sort <- metricas_all_sort[!is.na(metricas_all_sort$SJR), ]
    
    # get top 10 unique IDs
    uniqueID <- unique(metricas_all_sort$"ID da Produção")
    top <- min(length(uniqueID), 10, na.rm = TRUE)
    uniqueID_top <- uniqueID[1:top]
    metricas_all_sort_top <- metricas_all_sort[metricas_all_sort$"ID da Produção" %in% uniqueID_top, ]
    
    # Check for empty data
    if (!sjmisc::is_empty(metricas_all_sort_top)) {
      # print tab header
      cat('\n\n<!-- -->\n\n')
      cat("### **", as.character(years[year]), "**", "\n", sep = "")
      
      # print table of papers with/without badges
      source("Scripts/table-with-badges.R", local = knitr::knit_global())
      table.with.badges(
        show.Altmetric = TRUE,
        show.Dimensions = TRUE,
        show.PlumX = TRUE,
        show.CiteScore = TRUE,
        show.SJR = TRUE,
        show.Qualis = TRUE,
        metricas_all_produtos = metricas_all_sort_top
      )
    }
  }
}
```

<br>

## **Prêmios** {#premios .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !has.premios}
cat('<br>')
```

```{r premios, eval = has.premios}
premios <-
  readxl::read_excel("PPG/Prêmios.xlsx",
             sheet = 1,
             col_types = c("text"))

Abrir <- matrix(NA, nrow = dim(premios)[1])
colnames(Abrir) <- "Abrir"
# add hyperlinks
for (i in 1:dim(premios)[1]) {
  if (!is.na(premios[i, ncol(premios)])) {
    Abrir[i] <-
      paste0('<a href="',
             premios[i, ncol(premios)],
             '" target="_blank"',
             '>',
             # fontawesome icon
             fontawesome::fa("up-right-from-square"),
             '</a>')
  }
}
premios <- cbind(premios[,-ncol(premios)], Abrir)

# ordering by dates & titles
premios <-
  premios[order(
    premios[, 1],
    premios[, 2],
    decreasing = FALSE
  ),]

# print tables
source("Scripts/table-with-buttons.R", local = knitr::knit_global())
create_dt(premios, title = "Destaques - Prêmios")

# Print end of tab rows
cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
```

<br>

## **Prêmio CAPES de Tese** {#premio-capes .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

```{r, eval = !has.premio.capes}
cat('<br>')
```

```{r premio-capes, eval = has.premio.capes}
premio.capes <-
  readxl::read_excel("PPG/Prêmio CAPES de Tese.xlsx",
             sheet = 1,
             col_types = c("text"))

Abrir <- matrix(NA, nrow = dim(premio.capes)[1])
colnames(Abrir) <- "Abrir"
# add hyperlinks
for (i in 1:dim(premio.capes)[1]) {
  if (!is.na(premio.capes[i, ncol(premio.capes)])) {
    Abrir[i] <-
      paste0('<a href="',
             premio.capes[i, ncol(premio.capes)],
             '" target="_blank"',
             '>',
             # fontawesome icon
             fontawesome::fa("up-right-from-square"),
             '</a>')
  }
}
premio.capes <- cbind(premio.capes[,-ncol(premio.capes)], Abrir)

# ordering by dates & titles
premio.capes <-
  premio.capes[order(
    premio.capes[, 1],
    premio.capes[, 2],
    decreasing = FALSE
  ),]

# print tables
source("Scripts/table-with-buttons.R", local = knitr::knit_global())
create_dt(premio.capes, title = "Destaques - Prêmio CAPES de Tese")

# Print end of tab rows
cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
```

<br>

## **Representatividade** {#representatividade .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

### **Associações** {.tabset}

```{r associacoes, cache = TRUE, cache.path = "cache/associacoes/", eval = all(has.sucupira.files, curl::has_internet())}
# Docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# Keep active professors and remove duplicated data
sucupira <- sucupira.raw[is.na(sucupira.raw$`Data de Desligamento`), ]
sucupira.unique <- sucupira[!duplicated(sucupira$`Nome Docente`) & !is.na(sucupira$ORCID),]

orcids <- gsub("(.{14})(.*)$", "\\1-\\2",
               gsub("(.{9})(.*)$", "\\1-\\2",
                    gsub("(.{4})(.*)$", "\\1-\\2", sucupira.unique$ORCID)
                  )
              )

for (id in 1:length(orcids)) {
  assoc.name <- sucupira.unique$`Nome Docente`[id]
  my_orcid <- orcids[id]

  cat('\n\n<!-- -->\n\n')
  cat('#### **', as.character(id), '**', sep = "")
  cat('\n\n<!-- -->\n\n')
  cat('##### **', assoc.name, '**', sep = "")
  cat('\n\n<!-- -->\n\n')
  source("Scripts/orcid-memberships-services.R", local = knitr::knit_global())
  cat('\n\n<!-- -->\n\n')
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
}
```

<br>

### **Corpo editorial de periódicos** {.tabset}

```{r corpo-editorial, cache = TRUE, cache.path = "cache/corpo-editorial/", eval = all(has.sucupira.files, curl::has_internet())}
# Docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# Keep active professors and remove duplicated data
sucupira <- sucupira.raw[is.na(sucupira.raw$`Data de Desligamento`), ]
sucupira.unique <- sucupira[!duplicated(sucupira$`Nome Docente`) & !is.na(sucupira$ORCID),]

orcids <- gsub("(.{14})(.*)$", "\\1-\\2",
               gsub("(.{9})(.*)$", "\\1-\\2",
                    gsub("(.{4})(.*)$", "\\1-\\2", sucupira.unique$ORCID)
                  )
              )

for (id in 1:length(orcids)) {
  editor.name <- sucupira.unique$`Nome Docente`[id]
  my_orcid <- orcids[id]

  cat('\n\n<!-- -->\n\n')
  cat('#### **', as.character(id), '**', sep = "")
  cat('\n\n<!-- -->\n\n')
  cat('##### **', editor.name, '**', sep = "")
  cat('\n\n<!-- -->\n\n')
  source("Scripts/orcid-invited-positions.R", local = knitr::knit_global())
  cat('\n\n<!-- -->\n\n')
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
}
```

<br>

### **Revisor de periódicos** {.tabset}

```{r revisores, cache = TRUE, cache.path = "cache/revisores/", eval = all(has.sucupira.files, curl::has_internet())}
# Docentes
sheet <- "Docentes"
source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())

# Keep active professors and remove duplicated data
sucupira <- sucupira.raw[is.na(sucupira.raw$`Data de Desligamento`), ]
sucupira.unique <- sucupira[!duplicated(sucupira$`Nome Docente`) & !is.na(sucupira$ORCID),]

orcids <- gsub("(.{14})(.*)$", "\\1-\\2",
               gsub("(.{9})(.*)$", "\\1-\\2",
                    gsub("(.{4})(.*)$", "\\1-\\2", sucupira.unique$ORCID)
                  )
              )

for (id in 1:length(orcids)) {
  reviewer.name <- sucupira.unique$`Nome Docente`[id]
  my_orcid <- orcids[id]

  cat('\n\n<!-- -->\n\n')
  cat('#### **', as.character(id), '**', sep = "")
  cat('\n\n<!-- -->\n\n')
  cat('##### **', reviewer.name, '**', sep = "")
  cat('\n\n<!-- -->\n\n')
  source("Scripts/orcid-reviewer-board.R", local = knitr::knit_global())
  cat('\n\n<!-- -->\n\n')
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
}
```

<br>

## **Divulgação científica** {#divulgacao .tabset}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:black;background-color:black">

### **Blog institucional** {.tabset}

```{r blogs-ies, eval = has.blog.ies}
blog.ies <-
  readxl::read_excel("PPG/Blog institucional.xlsx",
             sheet = 1,
             col_types = c("text"))

Abrir <- matrix(NA, nrow = dim(blog.ies)[1])
colnames(Abrir) <- "Abrir"
# add hyperlinks
for (i in 1:dim(blog.ies)[1]) {
  if (!is.na(blog.ies[i, ncol(blog.ies)])) {
    Abrir[i] <-
      paste0('<a href="',
             blog.ies[i, ncol(blog.ies)],
             '" target="_blank"',
             '>',
             # fontawesome icon
             fontawesome::fa("up-right-from-square"),
             '</a>')
  }
}
blog.ies <- cbind(blog.ies[,-ncol(blog.ies)], Abrir)

# ordering by dates & titles
blog.ies <-
  blog.ies[order(
    blog.ies[, 1],
    blog.ies[, 2],
    decreasing = FALSE
  ),]

# print tables
source("Scripts/table-with-buttons.R", local = knitr::knit_global())
create_dt(blog.ies, title = "Destaques - Blog institucional")

# Print end of tab rows
cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
```

<br>

### **Blogs externos** {.tabset}

```{r blogs-externos, eval = has.blogs.externos}
blog.externos <-
  readxl::read_excel("PPG/Blogs externos.xlsx",
             sheet = 1,
             col_types = c("text"))

Abrir <- matrix(NA, nrow = dim(blog.externos)[1])
colnames(Abrir) <- "Abrir"
# add hyperlinks
for (i in 1:dim(blog.externos)[1]) {
  if (!is.na(blog.externos[i, ncol(blog.externos)])) {
    Abrir[i] <-
      paste0('<a href="',
             blog.externos[i, ncol(blog.externos)],
             '" target="_blank"',
             '>',
             # fontawesome icon
             fontawesome::fa("up-right-from-square"),
             '</a>')
  }
}
blog.externos <- cbind(blog.externos[,-ncol(blog.externos)], Abrir)

# ordering by dates & titles
blog.externos <-
  blog.externos[order(
    blog.externos[, 1],
    blog.externos[, 2],
    decreasing = FALSE
  ),]

# print tables
source("Scripts/table-with-buttons.R", local = knitr::knit_global())
create_dt(blog.externos, title = "Destaques - Blogs externos")

# Print end of tab rows
cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>', fontawesome::fa("circle-arrow-up"), '</a><br>')
```

<br>
